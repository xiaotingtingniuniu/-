(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{105:function(t,e,i){"use strict";var n=i(21),r=i(67),a=i(14);t.exports=function(t){for(var e=n(this),i=a(e.length),s=arguments.length,o=r(s>1?arguments[1]:void 0,i),l=s>2?arguments[2]:void 0,c=void 0===l?i:r(l,i);c>o;)e[o++]=t;return e}},209:function(t,e,i){var n=i(1),r=i(413);n({target:"Object",stat:!0,forced:Object.assign!==r},{assign:r})},210:function(t,e,i){var n=i(1),r=i(105),a=i(73);n({target:"Array",proto:!0},{fill:r}),a("fill")},665:function(t,e,i){"use strict";var n=i(75);e.a={methods:{onCopy:function(){this.$message({message:"复制成功",type:"success"})},showCopy:function(t){return t&&!Object(n.e)()}}}},733:function(t,e,i){},734:function(t,e,i){"use strict";i(182),i(130),i(183),i(50),i(208),i(209),i(31),i(185),i(129),i(102),i(80),i(138);var n=i(23),r=i.n(n),a=i(114),s=i(0),o=i(848);function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t){return function(t){if(Array.isArray(t))return m(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||v(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function u(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?h(Object(i),!0).forEach((function(e){d(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):h(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function d(t,e,i){return(e=function(t){var e=function(t,e){if("object"!==l(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===l(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function f(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=v(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){o=!0,a=t},f:function(){try{s||null==i.return||i.return()}finally{if(o)throw a}}}}function v(t,e){if(t){if("string"==typeof t)return m(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?m(t,e):void 0}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}e.a={data:function(){return{loadingImage:!0,loadingMoreParts:!0,image:"",parts:[],selectedPart:{},hoverPart:{},mouseDown:!1,startX:0,wrapper:null,toastMessage:"",cancelToken:[],tableWrapper:null,animeTime:0,animeId:null,startScrollTop:null,targetScrollTop:null}},computed:{loaded:function(){return!this.loadingImage&&!this.loadingMoreParts}},updated:function(){this.$refs.morePartsTable&&(this.wrapper=this.$refs.morePartsTable.$el.querySelector(".el-table__body-wrapper"),this.wrapper.removeEventListener("mousedown",this.handleMousedown),this.wrapper.addEventListener("mousedown",this.handleMousedown))},beforeDestroy:function(){this.cancelToken.map((function(t){return t.cancel("Request canceled")}))},methods:{parsePostion:function(t){var e,i=[],n=f(t.match(/((-)?\d+(\.\d+)?,(-)?\d+(\.\d+)?,\d+(\.\d+)?,\d+(\.\d+)?)/g)||[]);try{for(n.s();!(e=n.n()).done;){var r=e.value.split(",");i.push({x:+r[0],y:+r[1],w:+r[2],h:+r[3]})}}catch(t){n.e(t)}finally{n.f()}return i},isSamePosition:function(t,e){if(t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(t[i].x!==e[i].x||t[i].y!==e[i].y||t[i].w!==e[i].w||t[i].h!==e[i].h)return!1;return!0},tableRowClassName:function(t){var e=t.row,i=[];return e.hasParent?i.push("is-child"):e.hasChild&&i.push("is-parent"),"hover"===e.status?i.push("is-hovered"):"selected"===e.status&&i.push("is-selected"),e.hideBottomBorder&&i.push("hide-bottom-border"),i.join(" ")},handleRowClick:function(t){var e,i=f(this.parts);try{for(i.s();!(e=i.n()).done;){var n=e.value;t.coordinates&&n.coordinates&&this.isSamePosition(t.coordinates,n.coordinates)?n.status="selected":n.status=""}}catch(t){i.e(t)}finally{i.f()}t.status="selected",this.selectedPart=t},handleMousedown:function(t){this.mouseDown=!0,this.startX=t.clientX;var e=t.target;e.classList.contains("cell")||e.parentElement.classList.contains("cell")||document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp)},handleMouseMove:function(t){if(this.mouseDown){window.getSelection().removeAllRanges();var e=t.clientX-this.startX;this.startX=t.clientX;var i=this.wrapper.scrollLeft-e,n=this.wrapper.scrollWidth;i<0?i=0:i>n&&(i=n),this.wrapper.scrollLeft=i}},handleMouseUp:function(){this.mouseDown=!1,document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp)},handleMouseEnter:function(t){if("selected"!==t.status){var e,i=f(this.parts);try{for(i.s();!(e=i.n()).done;){var n=e.value;t.coordinates&&n.coordinates&&this.isSamePosition(t.coordinates,n.coordinates)?n.status="hover":"hover"===n.status&&(n.status="")}}catch(t){i.e(t)}finally{i.f()}t.status="hover",this.hoverPart=t}},handleMouseLeave:function(t){if("selected"!==t.status){t.status="",this.hoverPart={};var e,i=f(this.parts);try{for(i.s();!(e=i.n()).done;){var n=e.value;"hover"===n.status&&(n.status="")}}catch(t){i.e(t)}finally{i.f()}}},getPartImage:function(t){var e=this,i=t.prefix,n=t.imageName,o=t.firstLevelId,l=t.secondLevelId,c=t.source,h=r.a.CancelToken.source();this.cancelToken.push(h),this.loadingImage=!0,a.a.getPartImage({imagePrePath:i,imageName:n,firstLevelId:o,secondLevelId:l,source:c},{cancelToken:h.token}).then((function(t){if(t){var i=t.data,n=i.code,r=i.toastMessage,a=i.imageInfo;n===s.e.SUCCESS?e.imgList?e.imgList[e.selectedThumb]=a:e.image=a||"":e.toastMessage=r,e.loadingImage=!1}})).catch((function(t){console.error(t)}))},queryPartsByImage:function(t){var e=this,i=t.vinCode,n=t.optionCode,s=t.mjsid,o=t.vehicle,l=t.image,c=t.source,h=r.a.CancelToken.source();this.cancelToken.push(h),this.loadingMoreParts=!0,a.a.queryPartsByImage({vinCode:i,optionCode:n,mjsid:s,vehicle:o,image:l,source:c},{cancelToken:h.token}).then((function(t){if(t){var i=t.data.data||[];e.handleGetPartListResp(i,[]),e.loadingMoreParts=!1}})).catch((function(t){console.error(t)}))},handleGetPartListResp:function(t,e){var i=this;if(t&&t.length){this.addMark(t);for(var n=0;n<t.length;n++)t[n].priority=n,t[n].position&&(t[n].coordinates=this.parsePostion(t[n].position));var r,a=f(t);try{for(a.s();!(r=a.n()).done;){var s=r.value;if(s.child&&s.child.length){var o=Object.assign({},s,{hasChild:!0,hasParent:!1,status:"",__child:[]});e.push(o),s.__hasPushed=!0;var l,h=f(t);try{for(h.s();!(l=h.n()).done;){var d=l.value;s.child.includes(d.partNumber)&&(o.__child.push(Object.assign({},d,{hasChild:d.child&&d.child.length,hasParent:!0,status:""})),d.__hasPushed=!0)}}catch(t){h.e(t)}finally{h.f()}}else s.child&&s.child.length||s.parent&&s.parent.length||(e.push(Object.assign({},s,{hasChild:!1,hasParent:!1,status:""})),s.__hasPushed=!0)}}catch(t){a.e(t)}finally{a.f()}t.forEach((function(t){t.__hasPushed||e.push(Object.assign({},t,{hasChild:!1,hasParent:!1,status:""}))})),e.sort((function(t,e){return t.priority-e.priority}))}var v,m=f(e);try{var p=function(){var t,e=v.value;Array.isArray(e.__child)&&e.__child.length?(i.parts.push(u(u({},e),{},{hideBottomBorder:!0})),(t=i.parts).push.apply(t,c(e.__child.map((function(t,i){return u(u({},t),{},{hideBottomBorder:i<e.__child.length-1})}))))):i.parts.push(e)};for(m.s();!(v=m.n()).done;)p()}catch(t){m.e(t)}finally{m.f()}},addMark:function(t){var e=this;t.forEach((function(t){e.part&&t.partNumber===e.part.partNumber&&(t.isMarked=!0)}))},handleImageLoad:function(){if(this.$refs.imageBox&&this.$refs.partBox){var t=this.$refs.imageBox.clientHeight-this.$refs.partBox.clientHeight;t>=0&&(this.$refs.partBox.style.marginBottom=t+"px")}},handleSelectImage:function(t){if(this.$refs.morePartsTable){var e=this.$refs.morePartsTable.$el.querySelector(".el-table__body-wrapper"),i=e.getBoundingClientRect(),n=i.top,r=i.bottom;this.selectedPart=t,this.hoverPart={};var a=this.$refs.morePartsTable.$el.querySelectorAll(".is-selected");if(a&&a.length){var s,o=f(a);try{for(o.s();!(s=o.n()).done;){var l=s.value.getBoundingClientRect();if(l.top>n&&l.bottom<r)return}}catch(t){o.e(t)}finally{o.f()}var c=a[0].getBoundingClientRect().top,h=a[0].getBoundingClientRect().bottom,u=0,d=e.scrollTop-(i.bottom+i.top)/2;c<i.top?u=c+d:h>i.bottom&&(u=h+d),u&&(this.animeId&&cancelAnimationFrame(this.animeId),this.tableWrapper=e,this.startScrollTop=e.scrollTop,this.targetScrollTop=u,requestAnimationFrame(this.step))}}},step:function(t){if(this.animeTime=this.animeTime||t,t-this.animeTime<300){var e=o.a.linear((t-this.animeTime)/300)*(this.targetScrollTop-this.startScrollTop)+this.startScrollTop;this.tableWrapper.scrollTop=e,this.animeId=requestAnimationFrame(this.step)}else this.animeTime=0},scrollToCurrentPart:function(){var t=this,e=this.parts.find((function(t){return t.isMarked}));e&&setTimeout((function(){t.handleRowClick(e),t.$nextTick((function(){t.handleSelectImage(e)}))}),1e3)}}}},735:function(t,e,i){},794:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"viewer",staticClass:"image-viewer"},[i("div",{staticClass:"toolbar"},[i("div",{staticClass:"zoom"},[i("div",{staticClass:"viewer__btn btn-in",class:{"is-disabled":t.disableZoomIn},on:{click:t.handleZoomIn}}),t._v(" "),i("div",{staticClass:"viewer__btn btn-out",class:{"is-disabled":t.disableZoomOut},on:{click:t.handleZoomOut}})]),t._v(" "),t.disableReset?t._e():i("div",{staticClass:"viewer__btn btn-reset",on:{click:t.handleReset}},[i("p",[t._v("还原")])]),t._v(" "),t.showFullscreen?i("div",{staticClass:"viewer__btn btn-full",on:{click:t.handleFullscreen}},[i("p",[t._v("全屏")])]):t._e(),t._v(" "),t.showClose?i("div",{staticClass:"viewer__btn btn-close",on:{click:t.handleClose}},[i("p",[t._v("退出全屏")])]):t._e()]),t._v(" "),i("div",{ref:"viewerWrapper",staticClass:"wrapper"},[i("canvas",{ref:"viewerCanvas"})]),t._v(" "),t.message?i("div",{staticClass:"viewer__msg"},[i("span",[t._v(t._s(t.message))])]):t._e()])};n._withStripped=!0;i(138),i(210);CanvasRenderingContext2D.prototype.fillRoundRect=function(t,e,i,n,r){this.strokeStyle=this.fillStyle,this.roundRect(t,e,i,n,r).stroke(),this.fill()},CanvasRenderingContext2D.prototype.roundRect=function(t,e,i,n,r){return i<2*r&&(r=i/2),n<2*r&&(r=n/2),this.beginPath(),this.moveTo(t+r,e),this.arcTo(t+i,e,t+i,e+n,r),this.arcTo(t+i,e+n,t,e+n,r),this.arcTo(t,e+n,t,e,r),this.arcTo(t,e,t+i,e,r),this.closePath(),this};i(98),i(99),i(100),i(101),i(81),i(18);var r=i(124),a=i.n(r),s=i(848),o=i(75);function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return h(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return h(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){o=!0,a=t},f:function(){try{s||null==i.return||i.return()}finally{if(o)throw a}}}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(r=n.key,a=void 0,a=function(t,e){if("object"!==l(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===l(a)?a:String(a)),n)}var r,a}function f(t,e,i){return e&&d(t.prototype,e),i&&d(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}var v=function(){function t(e,i,n,r){var a=this;if(u(this,t),!e||!i)return this.handleError();this.canvas=e,this.ctx=e.getContext("2d"),this.ctx.imageSmoothingEnabled=!0,this.ctx.msImageSmoothingEnabled=!0,this.isFF=-1!==Object(o.c)(),this.dir=0,this.eventHandlers={down:{event:"mousedown",callback:"onMouseDown",element:this.canvas},hover:{event:"mousemove",callback:"onHover",element:this.canvas},drag:{event:"mousemove",callback:"onDrag",element:document},up:{event:"mouseup",callback:"onMouseUp",element:document},leave:{event:"mouseleave",callback:"onMouseLeave",element:this.canvas},scroll:{event:this.isFF?"DOMMouseScroll":"mousewheel",callback:"onWheel",element:this.canvas},click:{event:"click",callback:"onClick",element:this.canvas},resize:{event:"resize",callback:"onResize",element:window},contextmenu:{event:"contextmenu",callback:"onMenu",element:this.canvas}},this.error=!1,this.image=new Image,this.image.src=i,this.image.onload=function(){return a.init()},this.image.onerror=function(){return a.handleError()},this.parts=n.parts,this.hoveredPart=null,this.selectedPart=r.selectedPart,this.loaded=r.loaded,this.afterWheel=r.afterWheel,this.afterHover=r.afterHover,this.afterClick=r.afterClick,this.style={fixHeight:r.fixHeight||0,fixWidth:r.fixWidth||0},window.img=this}return f(t,[{key:"init",value:function(){this.initCanvasRect(),this.initImageInfo(),this.drawImage(0,0),this.drawPart(),this.addAllEventListener(),a.a.isFunction(this.loaded)&&this.loaded()}},{key:"handleError",value:function(){this.error=!0}},{key:"initCanvasRect",value:function(){this.dpi=devicePixelRatio||1;var t=this.style,e=t.fixHeight,i=t.fixWidth,n=this.canvas.parentElement;this.canvas.height=(n.clientHeight-e)*this.dpi,this.canvas.width=(n.clientWidth-i)*this.dpi,this.canvas.style.height="".concat(n.clientHeight-e,"px"),this.canvas.style.width="".concat(n.clientWidth-i,"px")}},{key:"initImageInfo",value:function(){var t=this.image.naturalHeight*this.dpi,e=this.image.naturalWidth*this.dpi,i=0,n=0,r=0;this.canvas.width/this.canvas.height<=e/t?n=(r=(i=this.canvas.width)/e)*t:i=(r=(n=this.canvas.height)/t)*e;var a=new m((this.canvas.width-i)/2,(this.canvas.height-n)/2);this.imageInfo={naturalHeight:t,naturalWidth:e,currentHeight:n,currentWidth:i,pos:a,minScale:r,scale:r,level:0},this.updateOverflow()}},{key:"updateOverflow",value:function(){var t=this.canvas.width-this.imageInfo.currentWidth,e=this.canvas.height-this.imageInfo.currentHeight;this.posRect=new p(new m(0,0),t,e)}},{key:"addAllEventListener",value:function(){for(var t in this.eventHandlers)"mousemove"!==t&&this.addEventListener(t)}},{key:"addEventListener",value:function(t){var e=this.eventHandlers[t],i=e.event,n=e.callback,r=e.element,a=this[n].bind(this);this.eventHandlers[t].bind=a,r.addEventListener(i,a,{passive:!1})}},{key:"removeAllEventListener",value:function(){for(var t in this.eventHandlers)this.removeEventListener(t)}},{key:"removeEventListener",value:function(t){var e=this.eventHandlers[t],i=e.event,n=e.bind;e.element.removeEventListener(i,n)}},{key:"onMouseDown",value:function(t){t.preventDefault(),this.mouseDown=!0,this.startX=t.clientX,this.startY=t.clientY,this.canvas.classList.add("grabbing"),this.addEventListener("drag")}},{key:"onMouseUp",value:function(t){t.preventDefault(),this.mouseDown=!1,this.canvas.classList.remove("grabbing"),this.removeEventListener("drag")}},{key:"onMouseLeave",value:function(){this.hoveredPart=null,this.drawImage(),this.drawPart()}},{key:"onDrag",value:function(t){if(this.mouseDown){t.preventDefault();var e=t.clientX-this.startX,i=t.clientY-this.startY;this.startX=t.clientX,this.startY=t.clientY,this.imageInfo.pos.add(e,i),this.drawImage(),this.drawPart()}}},{key:"onHover",value:function(t){var e=new m(t.offsetX*this.dpi,t.offsetY*this.dpi).subPoint(this.imageInfo.pos,!1),i=this.imageInfo.scale;if(this.hoveredPart=null,this.canvas.classList.remove("pointer"),e){var n,r=c(this.parts);try{for(r.s();!(n=r.n()).done;){var s=n.value,o=s.coordinates;if(o){var l,h=c(o);try{for(h.s();!(l=h.n()).done;){var u=l.value,d=u.x,f=u.y,v=u.w,y=u.h;if(new p(new m(d*i*this.dpi,f*i*this.dpi),v*i*this.dpi,y*i*this.dpi).contains(e).res){this.canvas.classList.add("pointer"),this.selectedPart!==s&&(this.hoveredPart=s);break}}}catch(t){h.e(t)}finally{h.f()}}}}catch(t){r.e(t)}finally{r.f()}}this.drawImage(),this.drawPart(),a.a.isFunction(this.afterHover)&&this.afterHover(this.hoveredPart)}},{key:"onWheel",value:function(t){t.preventDefault();var e=11*t.detail||-t.wheelDelta;this.dir*e<0?this.dir=e:this.dir+=e;var i=new m(t.offsetX,t.offsetY);this.dir<-30?(this.zoomIn(i),this.dir=0):this.dir>30&&(this.zoomOut(i),this.dir=0),a.a.isFunction(this.afterWheel)&&this.afterWheel()}},{key:"onClick",value:function(t){var e=new m(t.offsetX*this.dpi,t.offsetY*this.dpi).subPoint(this.imageInfo.pos,!1),i=this.imageInfo.scale;if(e){var n,r=c(this.parts);try{for(r.s();!(n=r.n()).done;){var s=n.value,o=s.coordinates;if(o){var l,h=c(o);try{for(h.s();!(l=h.n()).done;){var u=l.value,d=u.x,f=u.y,v=u.w,y=u.h;if(new p(new m(d*i*this.dpi,f*i*this.dpi),v*i*this.dpi,y*i*this.dpi).contains(e).res&&this.selectedPart!==s){this.selectedPart=s;break}}}catch(t){h.e(t)}finally{h.f()}}}}catch(t){r.e(t)}finally{r.f()}}this.drawImage(),this.drawPart(e),a.a.isFunction(this.afterClick)&&this.selectedPart&&this.afterClick(this.selectedPart)}},{key:"onMenu",value:function(t){t.preventDefault()}},{key:"onResize",value:function(){this.initCanvasRect(),this.reset()}},{key:"drawImage",value:function(){if(!this.error&&this.imageInfo){var t=this.imageInfo.pos,e=this.posRect.contains(t),i=e.posOnX,n=e.posOnY;i>0?t.x=this.posRect.x+this.posRect.width:i<0&&(t.x=this.posRect.x),n>0?t.y=this.posRect.y+this.posRect.height:n<0&&(t.y=this.posRect.y),this.imageInfo.pos=t,this.clearCanvas(),this.ctx.fillStyle="#fff",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height);var r=this.imageInfo,a=r.currentWidth,s=r.currentHeight;this.ctx.drawImage(this.image,t.x,t.y,a,s)}}},{key:"drawPart",value:function(){this.hoveredPart&&this.drawPartWithStyle(this.hoveredPart,"#ffa366","#fff"),this.selectedPart&&this.drawPartWithStyle(this.selectedPart,"#ff6600","#fff")}},{key:"drawPartWithStyle",value:function(t,e,i){if(t.coordinates&&!this.error&&this.imageInfo){var n,r=this.imageInfo,a=r.scale,s=r.pos,o=c(t.coordinates);try{for(o.s();!(n=o.n()).done;){var l=n.value,h=l.x*this.dpi,u=l.y*this.dpi,d=l.w*this.dpi,f=l.h*this.dpi,v=new p(new m(h*a,u*a),d*a,f*a);this.ctx.fillStyle=e,this.ctx.fillRoundRect(v.x+s.x,v.y+s.y,v.width,v.height,v.height/5),this.ctx.font="normal ".concat(Math.floor(.8*v.height),"px Arial"),this.ctx.fillStyle=i;var y=this.ctx.measureText(t.partRefOnImage);this.ctx.fillText(t.partRefOnImage,v.x+s.x+(v.width-y.width)/2,v.y+s.y+.8*v.height)}}catch(t){o.e(t)}finally{o.f()}}}},{key:"clearCanvas",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}},{key:"zoomIn",value:function(t){if(!this.error){this.imageInfo.level=Math.min(this.imageInfo.level+1,9);var e=this.getNewScale(this.imageInfo.level);this.zoom(t,e)}}},{key:"zoomOut",value:function(t){if(!this.error){this.imageInfo.level=Math.max(this.imageInfo.level-1,0);var e=this.getNewScale(this.imageInfo.level);this.zoom(t,e)}}},{key:"reset",value:function(){this.initImageInfo(),this.drawImage(0,0),this.drawPart()}},{key:"zoom",value:function(t,e){var i=e/this.imageInfo.scale;t=t||new m(this.canvas.width/2,this.canvas.height/2),this.imageInfo.pos=t.subPoint(t.subPoint(this.imageInfo.pos,!1).multi(i)),this.imageInfo.scale=e,this.imageInfo.currentHeight=this.imageInfo.naturalHeight*e,this.imageInfo.currentWidth=this.imageInfo.naturalWidth*e,this.updateOverflow(),this.drawImage(),this.drawPart()}},{key:"getNewScale",value:function(t){return this.imageInfo.minScale*[100,110,125,150,175,200,250,300,400,500][t]/100}},{key:"moveToSelectedPoint",value:function(){if(this.selectedPart.coordinates&&this.selectedPart.coordinates.length&&!this.error){window.cancelAnimationFrame(this.animeId);var t,e=new m(this.canvas.width/2,this.canvas.height/2),i=this.imageInfo,n=i.scale,r=i.pos,a=1/0,s=null,o=c(this.selectedPart.coordinates);try{for(o.s();!(t=o.n()).done;){var l=t.value,h=l.x*this.dpi,u=l.y*this.dpi,d=l.w*this.dpi,f=l.h*this.dpi,v=new m(h*n,u*n).addPoint(r,!1),y=v.distance(e);y<a&&(a=y,s=new p(v,d*n,f*n))}}catch(t){o.e(t)}finally{o.f()}if(s){var g=new p(new m(0,0),this.canvas.width,this.canvas.height),b=s.farest(e);if(g.contains(b).res)this.drawImage(),this.drawPart();else{var w=s.center();this.imageInfo.oldPos=this.imageInfo.pos,this.imageInfo.newPos=this.imageInfo.pos.addPoint(e.subPoint(w,!1),!1),this.animeTime=0,this.animeId=window.requestAnimationFrame(this.step.bind(this))}}}}},{key:"step",value:function(t){if(this.animeTime=this.animeTime||t,t-this.animeTime<800){var e=s.a.easeInOutCubic((t-this.animeTime)/800),i=e*(this.imageInfo.newPos.x-this.imageInfo.oldPos.x)+this.imageInfo.oldPos.x,n=e*(this.imageInfo.newPos.y-this.imageInfo.oldPos.y)+this.imageInfo.oldPos.y;this.imageInfo.pos=new m(i,n),this.drawImage(),this.drawPart(),this.animeId=window.requestAnimationFrame(this.step.bind(this))}else this.animeTime=0}}]),t}(),m=function(){function t(e,i){u(this,t),this.x=e,this.y=i}return f(t,[{key:"add",value:function(e,i){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return n?(this.x+=e,this.y+=i,this):new t(this.x+e,this.y+i)}},{key:"addPoint",value:function(e){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return i?(this.x+=e.x,this.y+=e.y,this):new t(this.x+e.x,this.y+e.y)}},{key:"sub",value:function(e,i){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return n?(this.x-=e,this.y-=i,this):new t(this.x-e,this.y-i)}},{key:"subPoint",value:function(e){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return i?(this.x-=e.x,this.y-=e.y,this):new t(this.x-e.x,this.y-e.y)}},{key:"multi",value:function(t){return this.x*=t,this.y*=t,this}},{key:"distance",value:function(t){return Math.pow(Math.pow(Math.abs(this.x-t.x),2)+Math.pow(Math.abs(this.y-t.y),2),.5)}}]),t}(),p=function(){function t(e,i,n){u(this,t),i<0&&(e.x+=i),n<0&&(e.y+=n),this.x=e.x,this.y=e.y,this.width=Math.abs(i),this.height=Math.abs(n)}return f(t,[{key:"contains",value:function(t){var e=t.x,i=t.y,n=NaN,r=NaN;return n=e<this.x?-1:e>this.x+this.width?1:0,r=i<this.y?-1:i>this.y+this.height?1:0,{res:0===n&&0===r,posOnX:n,posOnY:r}}},{key:"allPoint",value:function(){return[new m(this.x,this.y),new m(this.x+this.width,this.y),new m(this.x+this.width,this.y+this.height),new m(this.x,this.y+this.height)]}},{key:"center",value:function(){return new m(this.x+this.width/2,this.y+this.height/2)}},{key:"farest",value:function(t){var e,i=0,n=null,r=c(this.allPoint());try{for(r.s();!(e=r.n()).done;){var a=e.value,s=a.distance(t);s>i&&(i=s,n=a)}}catch(t){r.e(t)}finally{r.f()}return n}}]),t}();function y(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return g(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return g(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){o=!0,a=t},f:function(){try{s||null==i.return||i.return()}finally{if(o)throw a}}}}function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var b={props:{src:{type:String,required:!0},parts:{type:Array,required:!0},selectedItem:{type:Object,required:!0},hoveredItem:{type:Object,required:!0},showFullscreen:{type:Boolean,required:!1,default:!1},showClose:{type:Boolean,required:!1,default:!1},message:{type:String,required:!1,default:""}},data:function(){return{disableZoomIn:!1,disableZoomOut:!0,imageViewer:null}},computed:{disableReset:function(){return this.disableZoomOut}},watch:{selectedItem:function(t){this.imageViewer.selectedPart=t,this.imageViewer.moveToSelectedPoint()},hoveredItem:function(t){this.imageViewer.hoveredPart=t,this.imageViewer.drawImage(),this.imageViewer.drawPart()}},mounted:function(){var t,e,i,n,r=this;this.imageViewer=(t=this.$refs.viewerCanvas,e=this.src,i={parts:this.parts},n={loaded:function(){return r.$emit("load")},selectedPart:this.selectedItem,afterWheel:this.updateZoomButton,afterHover:this.updateHoverdPart,afterClick:this.updateSelectedPart},new v(t,e,i,n)),this.message&&setTimeout((function(){r.$emit("load")}),500)},beforeDestroy:function(){this.imageViewer.removeAllEventListener()},methods:{updateHoverdPart:function(t){var e,i=y(this.parts);try{for(i.s();!(e=i.n()).done;){var n=e.value;"selected"!==n.status&&(t&&t.position===n.position?n.status="hover":n.status="")}}catch(t){i.e(t)}finally{i.f()}},updateSelectedPart:function(t){var e=this;if(t.position){var i,n=y(this.parts);try{for(n.s();!(i=n.n()).done;){var r=i.value;t.position===r.position?r.status="selected":r.status=""}}catch(t){n.e(t)}finally{n.f()}this.$nextTick((function(){e.$emit("select",t)}))}},updateZoomButton:function(){if(this.imageViewer.error)return!1;this.disableZoomIn=9===this.imageViewer.imageInfo.level,this.disableZoomOut=0===this.imageViewer.imageInfo.level},handleZoomIn:function(){if(this.disableZoomIn)return!1;this.imageViewer.zoomIn(),this.updateZoomButton()},handleZoomOut:function(){if(this.disableZoomOut)return!1;this.imageViewer.zoomOut(),this.updateZoomButton()},handleReset:function(){if(this.disableReset)return!1;this.imageViewer.reset(),this.updateZoomButton()},handleFullscreen:function(){this.$emit("full-screen")},handleClose:function(){this.$emit("close")}}},w=(i(967),i(649)),P=Object(w.a)(b,n,[],!1,null,"31416c70",null);P.options.__file="app/components/ImageViewer.vue";e.a=P.exports},848:function(t,e,i){"use strict";i(189);var n=Object.freeze({linear:function(t){return t},easeInQuad:function(t){return Math.pow(t,2)},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*Math.pow(t,2):(4-2*t)*t-1},easeInCubic:function(t){return Math.pow(t,3)},easeOutCubic:function(t){return Math.pow(--t,3)+1},easeInOutCubic:function(t){return t<.5?4*Math.pow(t,3):(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return Math.pow(t,4)},easeOutQuart:function(t){return 1-Math.pow(--t,4)},easeInOutQuart:function(t){return t<.5?8*Math.pow(t,4):1-8*Math.pow(--t,4)},easeInQuint:function(t){return Math.pow(t,5)},easeOutQuint:function(t){return 1+Math.pow(--t,5)},easeInOutQuint:function(t){return t<.5?16*Math.pow(t,5):1+16*Math.pow(--t,5)}});e.a=n},849:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{staticClass:"dialog-part-details",attrs:{"modal-append-to-body":!1,visible:t.visible,fullscreen:!0,"show-close":!1,modal:!1},on:{"update:visible":function(e){t.visible=e},closed:t.handleClose}},[i("div",{staticClass:"wrap"},[i("div",{staticClass:"part-details__img"},[t.image?i("image-viewer",{ref:"imageViewer",attrs:{src:t.image,parts:t.parts,"selected-item":t.selectedPart,"hovered-item":t.hoverPart,"show-close":!0},on:{select:t.handleSelectImage,close:function(e){t.visible=!1}}}):t._e()],1),t._v(" "),t.parts?i("div",{staticClass:"part-details__parts"},[i("el-table",{ref:"morePartsTable",class:{"is-grabbing":t.mouseDown},staticStyle:{width:"100%"},attrs:{data:t.parts,"row-class-name":t.tableRowClassName,border:"",height:"100%"},on:{"row-click":t.handleRowClick,"cell-mouse-enter":t.handleMouseEnter,"cell-mouse-leave":t.handleMouseLeave}},[i("el-table-column",{attrs:{prop:"total",label:" ",width:"40",type:"index"},scopedSlots:t._u([{key:"default",fn:function(e){return i("div",{staticClass:"table_add",attrs:{id:e.$index},on:{click:function(i){return t.addPartsList(e.row,e.$index)}}})}}],null,!1,1352762559)}),t._v(" "),i("el-table-column",{attrs:{prop:"partRefOnImage",label:"图中编号",width:"99"},scopedSlots:t._u([{key:"default",fn:function(e){return[[t._v(t._s(e.row.partRefOnImage))],t._v(" "),e.row.hasParent?[i("el-tooltip",{attrs:{content:"局部配件",effect:"dark",placement:"top",transition:"tooltip-fade-in-linear"}},[i("div",{staticClass:"icon-partial"})])]:t._e(),t._v(" "),i("el-tooltip",{attrs:{content:"查询结果",effect:"dark",placement:"top",transition:"tooltip-fade-in-linear"}},[e.row.isMarked?i("div",{staticClass:"icon-current-part"}):t._e()])]}}],null,!1,4282589390)}),t._v(" "),i("el-table-column",{attrs:{prop:"stdPartName",label:"标准名",width:"130"}}),t._v(" "),i("el-table-column",{attrs:{prop:"srcPartName",label:"名称",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{staticClass:"color--gray"},[t._v(t._s(e.row.srcPartName))])]}}],null,!1,1804741986)}),t._v(" "),i("el-table-column",{attrs:{prop:"partPrice",label:"4S店价格",width:"100"}}),t._v(" "),i("el-table-column",{attrs:{prop:"partNumber",label:"现用 OE 号",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"oe"},[[t._v(t._s(e.row.partNumber))],t._v(" "),t.showCopy(e.row.partNumber)?i("span",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.row.partNumber,expression:"scope.row.partNumber",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"}],staticClass:"btn-copy is-oe"},[[t._v("复制")]],2):t._e()],2)]}}],null,!1,526238454)}),t._v(" "),i("el-table-column",{attrs:{prop:"substitute",label:"曾用 OE 号",width:"175"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"substitute"},[i("span",{staticClass:"is-gray"},[t._v(t._s(e.row.substitute))]),t._v(" "),t.showCopy(e.row.substitute)?i("span",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.row.substitute,expression:"scope.row.substitute",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"}],staticClass:"btn-copy"},[[t._v("复制")]],2):t._e()])]}}],null,!1,2602749732)}),t._v(" "),i("el-table-column",{attrs:{prop:"comment",label:"备注",width:"200"}})],1)],1):t._e()])])};n._withStripped=!0;i(98),i(99),i(100),i(101),i(81),i(209),i(18);var r=i(79),a=i(794),s=i(734),o=i(665);function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return h(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return h(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){o=!0,a=t},f:function(){try{s||null==i.return||i.return()}finally{if(o)throw a}}}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function u(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function d(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?u(Object(i),!0).forEach((function(e){f(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):u(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function f(t,e,i){return(e=function(t){var e=function(t,e){if("object"!==l(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===l(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var v={components:{ImageViewer:a.a},mixins:[s.a,o.a],props:{imageSrc:{type:String,required:!1,default:""},data:{type:Array,required:!0}},data:function(){return{visible:!0}},computed:d(d({},Object(r.e)("vinQuery",["currentVehicle"])),Object(r.e)("partDetails",["prefix","imgNameList","vehicle","oe","ref"])),created:function(){if(this.data&&this.data.length){var t,e=[],i=c(this.data);try{for(i.s();!(t=i.n()).done;){var n=t.value,r=Object.assign({},n);e.push(r),"selected"===r.status&&(this.selectedPart=r)}}catch(t){i.e(t)}finally{i.f()}this.parts=e}this.image=this.imageSrc},methods:d(d({},Object(r.b)("partsList",["addPart"])),{},{handleClose:function(){this.$emit("close")},addPartsList:function(t,e){this.vehicle,this.currentVehicle;var i={vehicle:"{}"!==JSON.stringify(this.currentVehicle)?this.currentVehicle:this.vehicle,part:t,index:e};document.getElementById(e).classList,document.getElementById(e).classList.length,this.addPart,this.addPart(i)}})},m=(i(968),i(649)),p=Object(m.a)(v,n,[],!1,null,"60b5704a",null);p.options.__file="app/components/DialogPartDetails.vue";e.a=p.exports},967:function(t,e,i){"use strict";var n=i(733);i.n(n).a},968:function(t,e,i){"use strict";var n=i(735);i.n(n).a}}]);