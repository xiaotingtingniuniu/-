(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{107:function(t,e,i){"use strict";var n=i(23),a=i(75),r=i(14);t.exports=function(t){for(var e=n(this),i=r(e.length),s=arguments.length,o=a(s>1?arguments[1]:void 0,i),l=s>2?arguments[2]:void 0,h=void 0===l?i:a(l,i);h>o;)e[o++]=t;return e}},210:function(t,e,i){var n=i(1),a=i(412);n({target:"Object",stat:!0,forced:Object.assign!==a},{assign:a})},211:function(t,e,i){var n=i(1),a=i(107),r=i(74);n({target:"Array",proto:!0},{fill:a}),r("fill")},665:function(t,e,i){"use strict";var n=i(77);e.a={methods:{onCopy:function(){this.$message({message:"复制成功",type:"success"})},showCopy:function(t){return t&&!Object(n.e)()}}}},737:function(t,e,i){},738:function(t,e,i){"use strict";i(82),i(133),i(134),i(100),i(184),i(67),i(135),i(137),i(66),i(186),i(49),i(132),i(131),i(210),i(101),i(102),i(103),i(24),i(30),i(83),i(188),i(81),i(136),i(104),i(68),i(84),i(144);var n=i(21),a=i.n(n),r=i(116),s=i(0),o=i(850);function l(t){return function(t){if(Array.isArray(t))return v(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||f(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function c(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?h(Object(i),!0).forEach((function(e){u(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):h(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function u(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function d(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=f(t))){var e=0,i=function(){};return{s:i,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a,r=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return r=t.done,t},e:function(t){s=!0,a=t},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw a}}}}function f(t,e){if(t){if("string"==typeof t)return v(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(i):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?v(t,e):void 0}}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}e.a={data:function(){return{loadingImage:!0,loadingMoreParts:!0,image:"",parts:[],selectedPart:{},hoverPart:{},mouseDown:!1,startX:0,wrapper:null,toastMessage:"",cancelToken:[],tableWrapper:null,animeTime:0,animeId:null,startScrollTop:null,targetScrollTop:null}},computed:{loaded:function(){return!this.loadingImage&&!this.loadingMoreParts}},updated:function(){this.$refs.morePartsTable&&(this.wrapper=this.$refs.morePartsTable.$el.querySelector(".el-table__body-wrapper"),this.wrapper.removeEventListener("mousedown",this.handleMousedown),this.wrapper.addEventListener("mousedown",this.handleMousedown))},beforeDestroy:function(){this.cancelToken.map((function(t){return t.cancel("Request canceled")}))},methods:{parsePostion:function(t){var e,i=[],n=d(t.match(/((-)?\d+(\.\d+)?,(-)?\d+(\.\d+)?,\d+(\.\d+)?,\d+(\.\d+)?)/g)||[]);try{for(n.s();!(e=n.n()).done;){var a=e.value.split(",");i.push({x:+a[0],y:+a[1],w:+a[2],h:+a[3]})}}catch(t){n.e(t)}finally{n.f()}return i},isSamePosition:function(t,e){if(t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(t[i].x!==e[i].x||t[i].y!==e[i].y||t[i].w!==e[i].w||t[i].h!==e[i].h)return!1;return!0},tableRowClassName:function(t){var e=t.row,i=[];return e.hasParent?i.push("is-child"):e.hasChild&&i.push("is-parent"),"hover"===e.status?i.push("is-hovered"):"selected"===e.status&&i.push("is-selected"),e.hideBottomBorder&&i.push("hide-bottom-border"),i.join(" ")},handleRowClick:function(t){var e,i=d(this.parts);try{for(i.s();!(e=i.n()).done;){var n=e.value;t.coordinates&&n.coordinates&&this.isSamePosition(t.coordinates,n.coordinates)?n.status="selected":n.status=""}}catch(t){i.e(t)}finally{i.f()}t.status="selected",this.selectedPart=t},handleMousedown:function(t){this.mouseDown=!0,this.startX=t.clientX;var e=t.target;e.classList.contains("cell")||e.parentElement.classList.contains("cell")||document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp)},handleMouseMove:function(t){if(this.mouseDown){window.getSelection().removeAllRanges();var e=t.clientX-this.startX;this.startX=t.clientX;var i=this.wrapper.scrollLeft-e,n=this.wrapper.scrollWidth;i<0?i=0:i>n&&(i=n),this.wrapper.scrollLeft=i}},handleMouseUp:function(){this.mouseDown=!1,document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp)},handleMouseEnter:function(t){if("selected"!==t.status){var e,i=d(this.parts);try{for(i.s();!(e=i.n()).done;){var n=e.value;t.coordinates&&n.coordinates&&this.isSamePosition(t.coordinates,n.coordinates)?n.status="hover":"hover"===n.status&&(n.status="")}}catch(t){i.e(t)}finally{i.f()}t.status="hover",this.hoverPart=t}},handleMouseLeave:function(t){if("selected"!==t.status){t.status="",this.hoverPart={};var e,i=d(this.parts);try{for(i.s();!(e=i.n()).done;){var n=e.value;"hover"===n.status&&(n.status="")}}catch(t){i.e(t)}finally{i.f()}}},getPartImage:function(t){var e=this,i=t.prefix,n=t.imageName,o=t.firstLevelId,l=t.secondLevelId,h=t.source,c=a.a.CancelToken.source();this.cancelToken.push(c),this.loadingImage=!0,r.a.getPartImage({imagePrePath:i,imageName:n,firstLevelId:o,secondLevelId:l,source:h},{cancelToken:c.token}).then((function(t){if(t){var i=t.data,n=i.code,a=i.toastMessage,r=i.imageInfo;n===s.e.SUCCESS?e.imgList?e.imgList[e.selectedThumb]=r:e.image=r||"":e.toastMessage=a,e.loadingImage=!1}})).catch((function(t){console.error(t)}))},queryPartsByImage:function(t){var e=this,i=t.vinCode,n=t.optionCode,s=t.mjsid,o=t.vehicle,l=t.image,h=t.source,c=a.a.CancelToken.source();this.cancelToken.push(c),this.loadingMoreParts=!0,r.a.queryPartsByImage({vinCode:i,optionCode:n,mjsid:s,vehicle:o,image:l,source:h},{cancelToken:c.token}).then((function(t){if(t){var i=t.data.data||[];e.handleGetPartListResp(i,[]),e.loadingMoreParts=!1}})).catch((function(t){console.error(t)}))},handleGetPartListResp:function(t,e){var i=this;if(t&&t.length){this.addMark(t);for(var n=0;n<t.length;n++)t[n].priority=n,t[n].position&&(t[n].coordinates=this.parsePostion(t[n].position));var a,r=d(t);try{for(r.s();!(a=r.n()).done;){var s=a.value;if(s.child&&s.child.length){var o=Object.assign({},s,{hasChild:!0,hasParent:!1,status:"",__child:[]});e.push(o),s.__hasPushed=!0;var h,u=d(t);try{for(u.s();!(h=u.n()).done;){var f=h.value;s.child.includes(f.partNumber)&&(o.__child.push(Object.assign({},f,{hasChild:f.child&&f.child.length,hasParent:!0,status:""})),f.__hasPushed=!0)}}catch(t){u.e(t)}finally{u.f()}}else s.child&&s.child.length||s.parent&&s.parent.length||(e.push(Object.assign({},s,{hasChild:!1,hasParent:!1,status:""})),s.__hasPushed=!0)}}catch(t){r.e(t)}finally{r.f()}t.forEach((function(t){t.__hasPushed||e.push(Object.assign({},t,{hasChild:!1,hasParent:!1,status:""}))})),e.sort((function(t,e){return t.priority-e.priority}))}var v,m=d(e);try{var p=function(){var t,e=v.value;Array.isArray(e.__child)&&e.__child.length?(i.parts.push(c({},e,{hideBottomBorder:!0})),(t=i.parts).push.apply(t,l(e.__child.map((function(t,i){return c({},t,{hideBottomBorder:i<e.__child.length-1})}))))):i.parts.push(e)};for(m.s();!(v=m.n()).done;)p()}catch(t){m.e(t)}finally{m.f()}},addMark:function(t){var e=this;t.forEach((function(t){e.part&&t.partNumber===e.part.partNumber&&(t.isMarked=!0)}))},handleImageLoad:function(){if(this.$refs.imageBox&&this.$refs.partBox){var t=this.$refs.imageBox.clientHeight-this.$refs.partBox.clientHeight;t>=0&&(this.$refs.partBox.style.marginBottom=t+"px")}},handleSelectImage:function(t){if(this.$refs.morePartsTable){var e=this.$refs.morePartsTable.$el.querySelector(".el-table__body-wrapper"),i=e.getBoundingClientRect(),n=i.top,a=i.bottom;this.selectedPart=t,this.hoverPart={};var r=this.$refs.morePartsTable.$el.querySelectorAll(".is-selected");if(r&&r.length){var s,o=d(r);try{for(o.s();!(s=o.n()).done;){var l=s.value.getBoundingClientRect();if(l.top>n&&l.bottom<a)return}}catch(t){o.e(t)}finally{o.f()}var h=r[0].getBoundingClientRect().top,c=r[0].getBoundingClientRect().bottom,u=0,f=e.scrollTop-(i.bottom+i.top)/2;h<i.top?u=h+f:c>i.bottom&&(u=c+f),u&&(this.animeId&&cancelAnimationFrame(this.animeId),this.tableWrapper=e,this.startScrollTop=e.scrollTop,this.targetScrollTop=u,requestAnimationFrame(this.step))}}},step:function(t){if(this.animeTime=this.animeTime||t,t-this.animeTime<300){var e=o.a.linear((t-this.animeTime)/300)*(this.targetScrollTop-this.startScrollTop)+this.startScrollTop;this.tableWrapper.scrollTop=e,this.animeId=requestAnimationFrame(this.step)}else this.animeTime=0},scrollToCurrentPart:function(){var t=this,e=this.parts.find((function(t){return t.isMarked}));e&&setTimeout((function(){t.handleRowClick(e),t.$nextTick((function(){t.handleSelectImage(e)}))}),1e3)}}}},739:function(t,e,i){},798:function(t,e,i){"use strict";i(82),i(133),i(134),i(135),i(66),i(132),i(131),i(24),i(83),i(81),i(84),i(144),i(211);CanvasRenderingContext2D.prototype.fillRoundRect=function(t,e,i,n,a){this.strokeStyle=this.fillStyle,this.roundRect(t,e,i,n,a).stroke(),this.fill()},CanvasRenderingContext2D.prototype.roundRect=function(t,e,i,n,a){return i<2*a&&(a=i/2),n<2*a&&(a=n/2),this.beginPath(),this.moveTo(t+a,e),this.arcTo(t+i,e,t+i,e+n,a),this.arcTo(t+i,e+n,t,e+n,a),this.arcTo(t,e+n,t,e,a),this.arcTo(t,e,t+i,e,a),this.closePath(),this};var n=i(125),a=i.n(n),r=i(850),s=i(77);function o(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return l(t,e)}(t))){var e=0,i=function(){};return{s:i,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a,r=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return r=t.done,t},e:function(t){s=!0,a=t},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw a}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,i){return e&&c(t.prototype,e),i&&c(t,i),t}var d=function(){function t(e,i,n,a){var r=this;if(h(this,t),!e||!i)return this.handleError();this.canvas=e,this.ctx=e.getContext("2d"),this.ctx.imageSmoothingEnabled=!0,this.ctx.msImageSmoothingEnabled=!0,this.isFF=-1!==Object(s.c)(),this.dir=0,this.eventHandlers={down:{event:"mousedown",callback:"onMouseDown",element:this.canvas},hover:{event:"mousemove",callback:"onHover",element:this.canvas},drag:{event:"mousemove",callback:"onDrag",element:document},up:{event:"mouseup",callback:"onMouseUp",element:document},leave:{event:"mouseleave",callback:"onMouseLeave",element:this.canvas},scroll:{event:this.isFF?"DOMMouseScroll":"mousewheel",callback:"onWheel",element:this.canvas},click:{event:"click",callback:"onClick",element:this.canvas},resize:{event:"resize",callback:"onResize",element:window},contextmenu:{event:"contextmenu",callback:"onMenu",element:this.canvas}},this.error=!1,this.image=new Image,this.image.src=i,this.image.onload=function(){return r.init()},this.image.onerror=function(){return r.handleError()},this.parts=n.parts,this.hoveredPart=null,this.selectedPart=a.selectedPart,this.loaded=a.loaded,this.afterWheel=a.afterWheel,this.afterHover=a.afterHover,this.afterClick=a.afterClick,this.style={fixHeight:a.fixHeight||0,fixWidth:a.fixWidth||0},window.img=this}return u(t,[{key:"init",value:function(){this.initCanvasRect(),this.initImageInfo(),this.drawImage(0,0),this.drawPart(),this.addAllEventListener(),a.a.isFunction(this.loaded)&&this.loaded()}},{key:"handleError",value:function(){this.error=!0}},{key:"initCanvasRect",value:function(){this.dpi=devicePixelRatio||1;var t=this.style,e=t.fixHeight,i=t.fixWidth,n=this.canvas.parentElement;this.canvas.height=(n.clientHeight-e)*this.dpi,this.canvas.width=(n.clientWidth-i)*this.dpi,this.canvas.style.height="".concat(n.clientHeight-e,"px"),this.canvas.style.width="".concat(n.clientWidth-i,"px")}},{key:"initImageInfo",value:function(){var t=this.image.naturalHeight*this.dpi,e=this.image.naturalWidth*this.dpi,i=0,n=0,a=0;this.canvas.width/this.canvas.height<=e/t?n=(a=(i=this.canvas.width)/e)*t:i=(a=(n=this.canvas.height)/t)*e;var r=new f((this.canvas.width-i)/2,(this.canvas.height-n)/2);this.imageInfo={naturalHeight:t,naturalWidth:e,currentHeight:n,currentWidth:i,pos:r,minScale:a,scale:a,level:0},this.updateOverflow()}},{key:"updateOverflow",value:function(){var t=this.canvas.width-this.imageInfo.currentWidth,e=this.canvas.height-this.imageInfo.currentHeight;this.posRect=new v(new f(0,0),t,e)}},{key:"addAllEventListener",value:function(){for(var t in this.eventHandlers)"mousemove"!==t&&this.addEventListener(t)}},{key:"addEventListener",value:function(t){var e=this.eventHandlers[t],i=e.event,n=e.callback,a=e.element,r=this[n].bind(this);this.eventHandlers[t].bind=r,a.addEventListener(i,r,{passive:!1})}},{key:"removeAllEventListener",value:function(){for(var t in this.eventHandlers)this.removeEventListener(t)}},{key:"removeEventListener",value:function(t){var e=this.eventHandlers[t],i=e.event,n=e.bind;e.element.removeEventListener(i,n)}},{key:"onMouseDown",value:function(t){t.preventDefault(),this.mouseDown=!0,this.startX=t.clientX,this.startY=t.clientY,this.canvas.classList.add("grabbing"),this.addEventListener("drag")}},{key:"onMouseUp",value:function(t){t.preventDefault(),this.mouseDown=!1,this.canvas.classList.remove("grabbing"),this.removeEventListener("drag")}},{key:"onMouseLeave",value:function(){this.hoveredPart=null,this.drawImage(),this.drawPart()}},{key:"onDrag",value:function(t){if(this.mouseDown){t.preventDefault();var e=t.clientX-this.startX,i=t.clientY-this.startY;this.startX=t.clientX,this.startY=t.clientY,this.imageInfo.pos.add(e,i),this.drawImage(),this.drawPart()}}},{key:"onHover",value:function(t){var e=new f(t.offsetX*this.dpi,t.offsetY*this.dpi).subPoint(this.imageInfo.pos,!1),i=this.imageInfo.scale;if(this.hoveredPart=null,this.canvas.classList.remove("pointer"),e){var n,r=o(this.parts);try{for(r.s();!(n=r.n()).done;){var s=n.value,l=s.coordinates;if(l){var h,c=o(l);try{for(c.s();!(h=c.n()).done;){var u=h.value,d=u.x,m=u.y,p=u.w,g=u.h;if(new v(new f(d*i*this.dpi,m*i*this.dpi),p*i*this.dpi,g*i*this.dpi).contains(e).res){this.canvas.classList.add("pointer"),this.selectedPart!==s&&(this.hoveredPart=s);break}}}catch(t){c.e(t)}finally{c.f()}}}}catch(t){r.e(t)}finally{r.f()}}this.drawImage(),this.drawPart(),a.a.isFunction(this.afterHover)&&this.afterHover(this.hoveredPart)}},{key:"onWheel",value:function(t){t.preventDefault();var e=11*t.detail||-t.wheelDelta;this.dir*e<0?this.dir=e:this.dir+=e;var i=new f(t.offsetX,t.offsetY);this.dir<-30?(this.zoomIn(i),this.dir=0):this.dir>30&&(this.zoomOut(i),this.dir=0),a.a.isFunction(this.afterWheel)&&this.afterWheel()}},{key:"onClick",value:function(t){var e=new f(t.offsetX*this.dpi,t.offsetY*this.dpi).subPoint(this.imageInfo.pos,!1),i=this.imageInfo.scale;if(e){var n,r=o(this.parts);try{for(r.s();!(n=r.n()).done;){var s=n.value,l=s.coordinates;if(l){var h,c=o(l);try{for(c.s();!(h=c.n()).done;){var u=h.value,d=u.x,m=u.y,p=u.w,g=u.h;if(new v(new f(d*i*this.dpi,m*i*this.dpi),p*i*this.dpi,g*i*this.dpi).contains(e).res&&this.selectedPart!==s){this.selectedPart=s;break}}}catch(t){c.e(t)}finally{c.f()}}}}catch(t){r.e(t)}finally{r.f()}}this.drawImage(),this.drawPart(e),a.a.isFunction(this.afterClick)&&this.selectedPart&&this.afterClick(this.selectedPart)}},{key:"onMenu",value:function(t){t.preventDefault()}},{key:"onResize",value:function(){this.initCanvasRect(),this.reset()}},{key:"drawImage",value:function(){if(!this.error&&this.imageInfo){var t=this.imageInfo.pos,e=this.posRect.contains(t),i=e.posOnX,n=e.posOnY;i>0?t.x=this.posRect.x+this.posRect.width:i<0&&(t.x=this.posRect.x),n>0?t.y=this.posRect.y+this.posRect.height:n<0&&(t.y=this.posRect.y),this.imageInfo.pos=t,this.clearCanvas(),this.ctx.fillStyle="#fff",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height);var a=this.imageInfo,r=a.currentWidth,s=a.currentHeight;this.ctx.drawImage(this.image,t.x,t.y,r,s)}}},{key:"drawPart",value:function(){this.hoveredPart&&this.drawPartWithStyle(this.hoveredPart,"#ffa366","#fff"),this.selectedPart&&this.drawPartWithStyle(this.selectedPart,"#ff6600","#fff")}},{key:"drawPartWithStyle",value:function(t,e,i){if(t.coordinates&&!this.error&&this.imageInfo){var n,a=this.imageInfo,r=a.scale,s=a.pos,l=o(t.coordinates);try{for(l.s();!(n=l.n()).done;){var h=n.value,c=h.x*this.dpi,u=h.y*this.dpi,d=h.w*this.dpi,m=h.h*this.dpi,p=new v(new f(c*r,u*r),d*r,m*r);this.ctx.fillStyle=e,this.ctx.fillRoundRect(p.x+s.x,p.y+s.y,p.width,p.height,p.height/5),this.ctx.font="normal ".concat(Math.floor(.8*p.height),"px Arial"),this.ctx.fillStyle=i;var g=this.ctx.measureText(t.partRefOnImage);this.ctx.fillText(t.partRefOnImage,p.x+s.x+(p.width-g.width)/2,p.y+s.y+.8*p.height)}}catch(t){l.e(t)}finally{l.f()}}}},{key:"clearCanvas",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}},{key:"zoomIn",value:function(t){if(!this.error){this.imageInfo.level=Math.min(this.imageInfo.level+1,9);var e=this.getNewScale(this.imageInfo.level);this.zoom(t,e)}}},{key:"zoomOut",value:function(t){if(!this.error){this.imageInfo.level=Math.max(this.imageInfo.level-1,0);var e=this.getNewScale(this.imageInfo.level);this.zoom(t,e)}}},{key:"reset",value:function(){this.initImageInfo(),this.drawImage(0,0),this.drawPart()}},{key:"zoom",value:function(t,e){var i=e/this.imageInfo.scale;t=t||new f(this.canvas.width/2,this.canvas.height/2),this.imageInfo.pos=t.subPoint(t.subPoint(this.imageInfo.pos,!1).multi(i)),this.imageInfo.scale=e,this.imageInfo.currentHeight=this.imageInfo.naturalHeight*e,this.imageInfo.currentWidth=this.imageInfo.naturalWidth*e,this.updateOverflow(),this.drawImage(),this.drawPart()}},{key:"getNewScale",value:function(t){return this.imageInfo.minScale*[100,110,125,150,175,200,250,300,400,500][t]/100}},{key:"moveToSelectedPoint",value:function(){if(this.selectedPart.coordinates&&this.selectedPart.coordinates.length&&!this.error){window.cancelAnimationFrame(this.animeId);var t,e=new f(this.canvas.width/2,this.canvas.height/2),i=this.imageInfo,n=i.scale,a=i.pos,r=1/0,s=null,l=o(this.selectedPart.coordinates);try{for(l.s();!(t=l.n()).done;){var h=t.value,c=h.x*this.dpi,u=h.y*this.dpi,d=h.w*this.dpi,m=h.h*this.dpi,p=new f(c*n,u*n).addPoint(a,!1),g=p.distance(e);g<r&&(r=g,s=new v(p,d*n,m*n))}}catch(t){l.e(t)}finally{l.f()}if(s){var y=new v(new f(0,0),this.canvas.width,this.canvas.height),w=s.farest(e);if(y.contains(w).res)this.drawImage(),this.drawPart();else{var b=s.center();this.imageInfo.oldPos=this.imageInfo.pos,this.imageInfo.newPos=this.imageInfo.pos.addPoint(e.subPoint(b,!1),!1),this.animeTime=0,this.animeId=window.requestAnimationFrame(this.step.bind(this))}}}}},{key:"step",value:function(t){if(this.animeTime=this.animeTime||t,t-this.animeTime<800){var e=r.a.easeInOutCubic((t-this.animeTime)/800),i=e*(this.imageInfo.newPos.x-this.imageInfo.oldPos.x)+this.imageInfo.oldPos.x,n=e*(this.imageInfo.newPos.y-this.imageInfo.oldPos.y)+this.imageInfo.oldPos.y;this.imageInfo.pos=new f(i,n),this.drawImage(),this.drawPart(),this.animeId=window.requestAnimationFrame(this.step.bind(this))}else this.animeTime=0}}]),t}(),f=function(){function t(e,i){h(this,t),this.x=e,this.y=i}return u(t,[{key:"add",value:function(e,i){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return n?(this.x+=e,this.y+=i,this):new t(this.x+e,this.y+i)}},{key:"addPoint",value:function(e){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return i?(this.x+=e.x,this.y+=e.y,this):new t(this.x+e.x,this.y+e.y)}},{key:"sub",value:function(e,i){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return n?(this.x-=e,this.y-=i,this):new t(this.x-e,this.y-i)}},{key:"subPoint",value:function(e){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return i?(this.x-=e.x,this.y-=e.y,this):new t(this.x-e.x,this.y-e.y)}},{key:"multi",value:function(t){return this.x*=t,this.y*=t,this}},{key:"distance",value:function(t){return Math.pow(Math.pow(Math.abs(this.x-t.x),2)+Math.pow(Math.abs(this.y-t.y),2),.5)}}]),t}(),v=function(){function t(e,i,n){h(this,t),i<0&&(e.x+=i),n<0&&(e.y+=n),this.x=e.x,this.y=e.y,this.width=Math.abs(i),this.height=Math.abs(n)}return u(t,[{key:"contains",value:function(t){var e=t.x,i=t.y,n=NaN,a=NaN;return n=e<this.x?-1:e>this.x+this.width?1:0,a=i<this.y?-1:i>this.y+this.height?1:0,{res:0===n&&0===a,posOnX:n,posOnY:a}}},{key:"allPoint",value:function(){return[new f(this.x,this.y),new f(this.x+this.width,this.y),new f(this.x+this.width,this.y+this.height),new f(this.x,this.y+this.height)]}},{key:"center",value:function(){return new f(this.x+this.width/2,this.y+this.height/2)}},{key:"farest",value:function(t){var e,i=0,n=null,a=o(this.allPoint());try{for(a.s();!(e=a.n()).done;){var r=e.value,s=r.distance(t);s>i&&(i=s,n=r)}}catch(t){a.e(t)}finally{a.f()}return n}}]),t}();function m(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return p(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return p(t,e)}(t))){var e=0,i=function(){};return{s:i,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a,r=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return r=t.done,t},e:function(t){s=!0,a=t},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw a}}}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var g={props:{src:{type:String,required:!0},parts:{type:Array,required:!0},selectedItem:{type:Object,required:!0},hoveredItem:{type:Object,required:!0},showFullscreen:{type:Boolean,required:!1,default:!1},showClose:{type:Boolean,required:!1,default:!1},message:{type:String,required:!1,default:""}},data:function(){return{disableZoomIn:!1,disableZoomOut:!0,imageViewer:null}},computed:{disableReset:function(){return this.disableZoomOut}},watch:{selectedItem:function(t){this.imageViewer.selectedPart=t,this.imageViewer.moveToSelectedPoint()},hoveredItem:function(t){this.imageViewer.hoveredPart=t,this.imageViewer.drawImage(),this.imageViewer.drawPart()}},mounted:function(){var t,e,i,n,a=this;this.imageViewer=(t=this.$refs.viewerCanvas,e=this.src,i={parts:this.parts},n={loaded:function(){return a.$emit("load")},selectedPart:this.selectedItem,afterWheel:this.updateZoomButton,afterHover:this.updateHoverdPart,afterClick:this.updateSelectedPart},new d(t,e,i,n)),this.message&&setTimeout((function(){a.$emit("load")}),500)},beforeDestroy:function(){this.imageViewer.removeAllEventListener()},methods:{updateHoverdPart:function(t){var e,i=m(this.parts);try{for(i.s();!(e=i.n()).done;){var n=e.value;"selected"!==n.status&&(t&&t.position===n.position?n.status="hover":n.status="")}}catch(t){i.e(t)}finally{i.f()}},updateSelectedPart:function(t){var e=this;if(t.position){var i,n=m(this.parts);try{for(n.s();!(i=n.n()).done;){var a=i.value;t.position===a.position?a.status="selected":a.status=""}}catch(t){n.e(t)}finally{n.f()}this.$nextTick((function(){e.$emit("select",t)}))}},updateZoomButton:function(){if(this.imageViewer.error)return!1;this.disableZoomIn=9===this.imageViewer.imageInfo.level,this.disableZoomOut=0===this.imageViewer.imageInfo.level},handleZoomIn:function(){if(this.disableZoomIn)return!1;this.imageViewer.zoomIn(),this.updateZoomButton()},handleZoomOut:function(){if(this.disableZoomOut)return!1;this.imageViewer.zoomOut(),this.updateZoomButton()},handleReset:function(){if(this.disableReset)return!1;this.imageViewer.reset(),this.updateZoomButton()},handleFullscreen:function(){this.$emit("full-screen")},handleClose:function(){this.$emit("close")}}},y=(i(969),i(649)),w=Object(y.a)(g,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"viewer",staticClass:"image-viewer"},[i("div",{staticClass:"toolbar"},[i("div",{staticClass:"zoom"},[i("div",{staticClass:"viewer__btn btn-in",class:{"is-disabled":t.disableZoomIn},on:{click:t.handleZoomIn}}),t._v(" "),i("div",{staticClass:"viewer__btn btn-out",class:{"is-disabled":t.disableZoomOut},on:{click:t.handleZoomOut}})]),t._v(" "),t.disableReset?t._e():i("div",{staticClass:"viewer__btn btn-reset",on:{click:t.handleReset}},[i("p",[t._v("还原")])]),t._v(" "),t.showFullscreen?i("div",{staticClass:"viewer__btn btn-full",on:{click:t.handleFullscreen}},[i("p",[t._v("全屏")])]):t._e(),t._v(" "),t.showClose?i("div",{staticClass:"viewer__btn btn-close",on:{click:t.handleClose}},[i("p",[t._v("退出全屏")])]):t._e()]),t._v(" "),i("div",{ref:"viewerWrapper",staticClass:"wrapper"},[i("canvas",{ref:"viewerCanvas"})]),t._v(" "),t.message?i("div",{staticClass:"viewer__msg"},[i("span",[t._v(t._s(t.message))])]):t._e()])}),[],!1,null,"584dbeff",null);e.a=w.exports},850:function(t,e,i){"use strict";i(192);var n=Object.freeze({linear:function(t){return t},easeInQuad:function(t){return Math.pow(t,2)},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*Math.pow(t,2):(4-2*t)*t-1},easeInCubic:function(t){return Math.pow(t,3)},easeOutCubic:function(t){return Math.pow(--t,3)+1},easeInOutCubic:function(t){return t<.5?4*Math.pow(t,3):(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return Math.pow(t,4)},easeOutQuart:function(t){return 1-Math.pow(--t,4)},easeInOutQuart:function(t){return t<.5?8*Math.pow(t,4):1-8*Math.pow(--t,4)},easeInQuint:function(t){return Math.pow(t,5)},easeOutQuint:function(t){return 1+Math.pow(--t,5)},easeInOutQuint:function(t){return t<.5?16*Math.pow(t,5):1+16*Math.pow(--t,5)}});e.a=n},851:function(t,e,i){"use strict";i(82),i(133),i(134),i(100),i(67),i(135),i(66),i(132),i(131),i(210),i(101),i(102),i(103),i(24),i(83),i(81),i(68),i(84);var n=i(80),a=i(798),r=i(738),s=i(665);function o(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return l(t,e)}(t))){var e=0,i=function(){};return{s:i,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a,r=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return r=t.done,t},e:function(t){s=!0,a=t},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw a}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function h(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function c(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?h(Object(i),!0).forEach((function(e){u(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):h(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function u(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var d={components:{ImageViewer:a.a},mixins:[r.a,s.a],props:{imageSrc:{type:String,required:!1,default:""},data:{type:Array,required:!0}},data:function(){return{visible:!0}},computed:c({},Object(n.e)("vinQuery",["currentVehicle"]),{},Object(n.e)("partDetails",["prefix","imgNameList","vehicle","oe","ref"])),created:function(){if(this.data&&this.data.length){var t,e=[],i=o(this.data);try{for(i.s();!(t=i.n()).done;){var n=t.value,a=Object.assign({},n);e.push(a),"selected"===a.status&&(this.selectedPart=a)}}catch(t){i.e(t)}finally{i.f()}this.parts=e}this.image=this.imageSrc},methods:c({},Object(n.b)("partsList",["addPart"]),{handleClose:function(){this.$emit("close")},addPartsList:function(t,e){this.vehicle,this.currentVehicle;var i={vehicle:"{}"!==JSON.stringify(this.currentVehicle)?this.currentVehicle:this.vehicle,part:t,index:e};document.getElementById(e).classList,document.getElementById(e).classList.length,this.addPart,this.addPart(i)}})},f=(i(970),i(649)),v=Object(f.a)(d,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{staticClass:"dialog-part-details",attrs:{"modal-append-to-body":!1,visible:t.visible,fullscreen:!0,"show-close":!1,modal:!1},on:{"update:visible":function(e){t.visible=e},closed:t.handleClose}},[i("div",{staticClass:"wrap"},[i("div",{staticClass:"part-details__img"},[t.image?i("image-viewer",{ref:"imageViewer",attrs:{src:t.image,parts:t.parts,"selected-item":t.selectedPart,"hovered-item":t.hoverPart,"show-close":!0},on:{select:t.handleSelectImage,close:function(e){t.visible=!1}}}):t._e()],1),t._v(" "),t.parts?i("div",{staticClass:"part-details__parts"},[i("el-table",{ref:"morePartsTable",class:{"is-grabbing":t.mouseDown},staticStyle:{width:"100%"},attrs:{data:t.parts,"row-class-name":t.tableRowClassName,border:"",height:"100%"},on:{"row-click":t.handleRowClick,"cell-mouse-enter":t.handleMouseEnter,"cell-mouse-leave":t.handleMouseLeave}},[i("el-table-column",{attrs:{prop:"total",label:" ",width:"40",type:"index"},scopedSlots:t._u([{key:"default",fn:function(e){return i("div",{staticClass:"table_add",attrs:{id:e.$index},on:{click:function(i){return t.addPartsList(e.row,e.$index)}}})}}],null,!1,1352762559)}),t._v(" "),i("el-table-column",{attrs:{prop:"partRefOnImage",label:"图中编号",width:"99"},scopedSlots:t._u([{key:"default",fn:function(e){return[[t._v(t._s(e.row.partRefOnImage))],t._v(" "),e.row.hasParent?[i("el-tooltip",{attrs:{content:"局部配件",effect:"dark",placement:"top",transition:"tooltip-fade-in-linear"}},[i("div",{staticClass:"icon-partial"})])]:t._e(),t._v(" "),i("el-tooltip",{attrs:{content:"查询结果",effect:"dark",placement:"top",transition:"tooltip-fade-in-linear"}},[e.row.isMarked?i("div",{staticClass:"icon-current-part"}):t._e()])]}}],null,!1,4282589390)}),t._v(" "),i("el-table-column",{attrs:{prop:"stdPartName",label:"标准名",width:"130"}}),t._v(" "),i("el-table-column",{attrs:{prop:"srcPartName",label:"名称",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{staticClass:"color--gray"},[t._v(t._s(e.row.srcPartName))])]}}],null,!1,1804741986)}),t._v(" "),i("el-table-column",{attrs:{prop:"partPrice",label:"4S店价格",width:"100"}}),t._v(" "),i("el-table-column",{attrs:{prop:"partNumber",label:"现用 OE 号",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"oe"},[[t._v(t._s(e.row.partNumber))],t._v(" "),t.showCopy(e.row.partNumber)?i("span",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.row.partNumber,expression:"scope.row.partNumber",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"}],staticClass:"btn-copy is-oe"},[[t._v("复制")]],2):t._e()],2)]}}],null,!1,526238454)}),t._v(" "),i("el-table-column",{attrs:{prop:"substitute",label:"曾用 OE 号",width:"175"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"substitute"},[i("span",{staticClass:"is-gray"},[t._v(t._s(e.row.substitute))]),t._v(" "),t.showCopy(e.row.substitute)?i("span",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.row.substitute,expression:"scope.row.substitute",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"}],staticClass:"btn-copy"},[[t._v("复制")]],2):t._e()])]}}],null,!1,2602749732)}),t._v(" "),i("el-table-column",{attrs:{prop:"comment",label:"备注",width:"200"}})],1)],1):t._e()])])}),[],!1,null,"d2eab750",null);e.a=v.exports},969:function(t,e,i){"use strict";var n=i(737);i.n(n).a},970:function(t,e,i){"use strict";var n=i(739);i.n(n).a}}]);